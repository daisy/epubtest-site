{%- extends 'base/base.njk' -%}
{%- set title="Test Books" -%}

{%- block content -%}
<script type="module" src="/js/data-table.js"></script>
<script type="module">
    import * as tableSettings from '/js/tables/test-books-table-settings.js';
    import * as helpers from '/js/tables/data-table-helpers.js';
    import { style } from '/js/data-table-style.js'; 

    let rows = {{testBooks | dump | safe}};

    let headers = [
        {
            title: "Topic",
            id: "topic"
        },
        {
            title: "Description",
            id: "description"
        },
        {
            title: "Title",
            id: "title"
        },   
        {
            title: "Version",
            id: "version"
        },
        {
            title: "Language",
            id: "language"
        },
        {
            title: "Download",
            id: "download"
        }
    ];
    
    let dataTable = document.querySelector("data-table");
    dataTable.bodyCellDisplay = tableSettings.bodyCellDisplay;
    dataTable.textSearchFilter = tableSettings.textSearchFilter;
    dataTable.css = style;
    dataTable.data = {headers, rows}; 
    
    window.addEventListener("resize", () => {
        dataTable.render();
    }); 
</script>
<main>
    <h2>Test books</h2>

    <p>Evaluations are completed with the same set of EPUB test books to ensure consistency. The test books are known to be accessible and free of errors. The different titles are described below, along with a link to download each.</p>
    
    <data-table 
        summary="Test book descriptions and downloads"
        showTextSearch="true"
    >
    </data-table>

    <noscript>
        <table class="striped" summary="Test book descriptions and downloads">
            <thead>
                <tr>
                    <th>Topic</th>
                    <th>Description</th>
                    <th>Title</th>
                    <th>Version</th>
                    <th>Language</th>
                    <th>Download</th>
                </tr>
            </thead>
            <tbody>
                {%- for testBook in testBooks -%}
                <tr>
                    <td>{{displayUtils.getTopicName(testBook.topicId)}}</td>
                    <td>{{testBook.title}}</td>
                    <td>{{testBook.version}}</td>
                    <td>{{testBook.langId}}</td>
                    <td>{{testBook.description}}</td>
                    <td>
                        <a href="/books/{{testBook.filename}}" title="{{testBook.title}}">Download</a>
                    </td>
                </tr>
                {%- endfor -%}
            </tbody>
        </table>
    </noscript>
</main>
    
{%- endblock -%}