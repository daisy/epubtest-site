{%- extends 'base/base.html' -%}
{%- block content -%}

{%- if pageTitle -%}
{%- set title = pageTitle -%}
<h1>{{pageTitle}}</h1>
{%- else -%}
{%- set title = "Set password" -%}
<h1>Set password</h1>
{%- endif -%}

{%- if pageMessage -%}
<p>{{pageMessage}}</p>
{%- endif -%}

<p id="local-error"></p>
<form method="POST" action="/user/forms/set-password" class="login simple-form" id="set-password-form">
  <div>
    <label for="password">Password</label>
    <input type="password" name="password" required/>
  </div>
  <div>
    <label for="passwordmatch">Password (again)</label>
    <input type="password" name="passwordmatch" required/>
  </div>
            
  <div class="actions">
    <input type="submit" name="submit" value="Set password" onclick="handleForm(this)" />
  </div>
  <input type="hidden" value="{{originUrl}}"/>
</form>

<script type="text/javascript">

let form = document.getElementById("set-password-form");

form.addEventListener("submit", function (event) {
  let password1 = form.elements.password.value; 
  let password2 = form.elements.passwordmatch.value; 
  
  if (password1 != password2) { 
    event.preventDefault();
    let elm = document.getElementById("local-error");
    elm.textContent = "Passwords must match!";
  } 
  else {
    this.submit();
  }
}, false);

</script>

{%- endblock -%}